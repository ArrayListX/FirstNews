riot.tag("weather",'<div class="w-header"> <span class="y-icon icon-location" onclick="{changeLocation}" ga_event="mh_change_city">&nbsp;{options.city}</span> <span class="wind">{options.wind}</span> <span class="air" riot-style="background: {options.level}">{options.air}</span> </div> <ul class="y-box days-weather {show: options.weather_show}"> <li class="y-left day"> <span class="title">ä»Šå¤©</span> <div title="{options.weather.current_condition}" class="weather-icon weather-icon-{options.weather.weather_icon_id}"></div> <span class="temperature"> <em>{options.weather.low_temperature}</em>&#176; &#47; <em>{options.weather.high_temperature}</em>&#176; </span> </li> <li class="y-left day"> <span class="title">æ˜å¤©</span> <div title="{options.weather.tomorrow_condition}" class="weather-icon weather-icon-{options.weather.tomorrow_weather_icon_id}"></div> <span class="temperature"> <em>{options.weather.tomorrow_low_temperature}</em>&#176; &#47; <em>{options.weather.tomorrow_high_temperature}</em>&#176; </span> </li> <li class="y-left day"> <span class="title">åå¤©</span> <div title="{options.weather.dat_condition}" class="weather-icon weather-icon-{options.weather.dat_weather_icon_id}"></div> <span class="temperature"> <em>{options.weather.dat_low_temperature}</em>&#176; &#47; <em>{options.weather.dat_high_temperature}</em>&#176; </span> </li> </ul> <div class="y-box city-select {show: !options.weather_show}"> <div class="y-box"> <div class="y-left select-style"> <p class="y-box"> <span class="y-left name">{options.current_province}</span> <span class="y-right y-icon icon-more" onclick="{showProvinces}"></span> </p> <div class="y-box province-list {show: options.province_show}"> <a class="y-left item" href="javascript:;" each="{item, i in options.locations}" onclick="{changeProvince}"> {item} </a> </div> </div> <div class="y-right select-style"> <p class="y-box"> <span class="y-left name">{options.current_city}</span> <span class="y-right y-icon icon-more" onclick="{showCities}"></span> </p> <div class="y-box city-list {show: options.city_show}"> <a class="y-left item" href="javascript:;" each="{item, i in options.cities}" onclick="{changeCity}"> {item} </a> </div> </div> </div> <div class="y-box action"> <a href="javascript:;" class="y-left ok-btn" onclick="{onSubmitClick}">ç¡®å®š</a> <a href="javascript:;" class="y-right cancel-btn" onclick="{onCancelClick}">å–æ¶ˆ</a> </div> </div>','class="y-weather"',function(){function t(t){var i=!0;return t>=0&&50>=t?{c:i?"#5cbf4c":"#5c8828",t:"ä¼˜"}:t>=51&&100>=t?{c:i?"#5cbf4c":"#5c8828",t:"è‰¯"}:t>=101&&150>=t?{c:i?"#ff9f2d":"#c58120",t:"è½»åº¦æ±¡æŸ“"}:t>=151&&200>=t?{c:i?"#ff9f2d":"#c58120",t:"ä¸­åº¦æ±¡æŸ“"}:t>=201&&300>=t?{c:i?"#ff5f5f":"#cf3d3d",t:"é‡åº¦æ±¡æŸ“"}:t>=301?{c:i?"#ff5f5f":"#cf3d3d",t:"ä¸¥é‡æ±¡æŸ“"}:{c:"rgba( 214, 117, 3, 0.8 )",t:"å…¶ä»–"}}this.options={current_province:"åŒ—äº¬",current_city:"åŒ—äº¬",province_show:!1,city_show:!1,weather_show:!0},riot.observable(this),this.on("weatherChange",function(t){this._renderWeather(t)}),this.init=function(){this._getCities()}.bind(this),this.showProvinces=function(){this.options.city_show=!1,this.options.province_show=!this.options.province_show}.bind(this),this.showCities=function(){this.options.province_show=!1,this.options.city_show=!this.options.city_show}.bind(this),this.changeLocation=function(){this.options.weather_show=!1}.bind(this),this.changeProvince=function(t){this.options.city_show=!1,this.options.province_show=!1,this.options.current_province=t.item.item,this._renderCities(t.item.item)}.bind(this),this.changeCity=function(t){this.options.city_show=!1,this.options.province_show=!1,this.options.current_city=t.item.item}.bind(this),this.onSubmitClick=function(){var t=this;this.options.weather_show=!0,this._getWeather({city:t.options.current_city})}.bind(this),this.onCancelClick=function(){this.options.weather_show=!0}.bind(this),this._getWeather=function(t){var i=this;http({url:"/stream/widget/local_weather/data/",method:"GET",data:t,success:function(t){t=t||{},"success"===t.message&&(i._renderWeather(t.data.weather),Cookies.set("WEATHER_CITY",t.data.city,{expires:100}),i.parent&&i.parent.trigger("weatherChange",t.data.weather))}})}.bind(this),this._renderWeather=function(i){this.options.weather=i,this.options.city=i.city_name,this.options.wind=i.wind_direction+i.wind_level+"çº§",this.options.air=i.quality_level+" "+i.aqi,this.options.level=t(i.aqi).c,this.update()}.bind(this),this._getCities=function(){var t=this;http({url:"/stream/widget/local_weather/city/",method:"GET",success:function(i){i=i||{},"success"===i.message&&(t.options.locations=i.data,t._renderCities(t.options.current_province))}})}.bind(this),this._renderCities=function(t){this.options.cities=this.options.locations[t];for(var i in this.options.cities){this.options.current_city=i;break}this.update()}.bind(this),this.on("mount",function(){this.init()})}),riot.tag("nav",'<div class="nav"> <ul class="y-box nav-list" ga_event="mh_channel"> <li each="{options.navItem}" class="y-left nav-item"> <a class="nav-link {active: location.pathname == url}" href="{url}" target="_blank" ga_event="mh_channel_{en}">{name}</a> </li> <li class="y-left nav-item nav-more"> <a class="nav-link" href="javascript:;"> æ›´å¤š<i class="y-icon icon-more"></i> </a> <div class="nav-layer"> <ul class="nav-more-list"> <li each="{options.navMore}" class="nav-more-item"> <a href="{url}" target="_blank" ga_event="mh_channel_{en}">{name}</a> </li> </ul> </div> </li> </ul> </div>',function(){this.options={navItem:[{name:"æ¨è",url:"/",en:"recommend"},{name:"çƒ­ç‚¹",url:"/ch/news_hot/",en:"hot"},{name:"è§†é¢‘",url:"/ch/video/",en:"video"},{name:"å›¾ç‰‡",url:"/ch/news_image/",en:"image"},{name:"æ®µå­",url:"/ch/essay_joke/",en:"essay"},{name:"å¨±ä¹",url:"/ch/news_entertainment/",en:"entertainment"},{name:"ç§‘æŠ€",url:"/ch/news_tech/",en:"tech"},{name:"æ±½è½¦",url:"/ch/news_car/",en:"car"},{name:"ä½“è‚²",url:"/ch/news_sports/",en:"sports"},{name:"è´¢ç»",url:"/ch/news_finance/",en:"finance"},{name:"å†›äº‹",url:"/ch/news_military/",en:"military"},{name:"å›½é™…",url:"/ch/news_world/",en:"world"},{name:"æ—¶å°š",url:"/ch/news_fashion/",en:"fashion"},{name:"æ—…æ¸¸",url:"/ch/news_travel/",en:"travel"}],navMore:[{name:"æ¢ç´¢",url:"/ch/news_discovery/",en:"discovery"},{name:"è‚²å„¿",url:"/ch/news_baby/",en:"baby"},{name:"å…»ç”Ÿ",url:"/ch/news_regimen/",en:"regimen"},{name:"ç¾æ–‡",url:"/ch/news_essay/",en:"essay"},{name:"æ¸¸æˆ",url:"/ch/news_game/",en:"game"},{name:"å†å²",url:"/ch/news_history/",en:"history"},{name:"ç¾é£Ÿ",url:"/ch/news_food/",en:"food"}]}}),riot.tag("wsearch",'<div name="searchBox" class="wsearch"> <form name="searchForm" action="/search/" method="get" target="_blank" onsubmit="{onSearchClick}"> <div name="inputbox" class="y-box input-group"> <input class="y-left input-text" name="keyword" value="{options.keyword}" autocomplete="off" ga_event="mh_search" type="text" placeholder="è¯·è¾“å…¥å…³é”®å­—" onkeyup="{onKeyup}" onfocus="{onFocus}" onblur="{onBlur}"> <div class="y-right btn-submit"> <button type="submit" href="javascript:;"> <i class="y-icon icon-search" ga_event="mh_search"></i> </button> </div> </div> </form> <div class="layer {layer-show: options.layershow}" if="{options.suggestList.length > 0}"> <ul ga_event="mh_search"> <li each="{item, i in options.suggestList}" class="search-item" onclick="{onSearchItemClick}"> <a href="javascript:;"> <i if="{options.isHotwords}" class="search-no search-no-{i+1}">{i + 1}</i> <i if="{!options.isHotwords}" class="search-sug"></i> <span class="search-txt">{item}</span> </a> </li> </ul> </div> </div>',function(t){function i(t){(t>=65&&90>=t||t>=48&&57>=t||t>=96&&111>=t||t>=186&&222>=t||8==t||46==t||32==t||13==t)&&(clearTimeout(o),o=setTimeout(function(){o=null,s(),e.update()},200)),e.update()}function s(){var t=e.keyword.value;""!=t.trim()&&http({url:"/search/sug/",data:{keyword:t},method:"get",success:function(t){"success"==t.message?(e.options.suggestList=t.data,e.options.layershow=!0):e.options.suggestList=[],e.options.isHotwords=!1,e.update()}})}var e=this,a=[];this.options={suggestList:[],keyword:"",searchTip:"å¤§å®¶éƒ½åœ¨æœï¼š",layershow:!1,isHotwords:!1},this.on("mount",function(){this.init()}),this.init=function(){!t.noHot&&this._getHotWords()}.bind(this),this._getHotWords=function(){http({url:"/hot_words/",method:"GET",success:function(t){t=t.hot_words||t||[],_.isArray(t)&&0!==t.length&&(e.options.suggestList=a=t,e.options.isHotwords=!0,e.options.keyword=e.options.searchTip+t[0],e.update())}})}.bind(this),this.onKeyup=function(t){""==this.keyword.value.trim()?(this.options.isHotwords=!0,this.options.suggestList=a):i(t.keyCode)}.bind(this),this.onFocus=function(){this.inputbox.style["border-color"]="#ed4040",this.options.keyword="",this.options.layershow=!0}.bind(this),this.onBlur=function(){this.inputbox.style["border-color"]="#e8e8e8",this.options.layershow=!1}.bind(this),this.onSearchClick=function(){var t,i=this.keyword.value;return i?(t=i.slice(0,6),t!==this.options.searchTip||(this.options.keyword=i.slice(6),this.options.keyword)?!0:(this.keyword.focus(),!1)):(this.keyword.focus(),!1)}.bind(this),this.onSearchItemClick=function(t){this.options.keyword=t.item.item,this.update(),this.searchForm.submit()}.bind(this);var o=null}),riot.tag("wtopbar",'<div class="y-box wtopbar"> <ul class="y-left" if="{opts.home}"> <li class="tb-item"> <a class="tb-link" href="http://app.toutiao.com/news_article/" target="_blank" ga_event="mh_nav_others">ä¸‹è½½APP</a> </li> <li class="tb-item weather" if="{opts.home}"> <a class="tb-link" href="javascript:;"> <span>&nbsp;{ options.city }</span> <span class="city_state">{ options.state }</span> <span class="city_temperature"> <em>{options.low}</em>&#176; &nbsp;&#47;&nbsp; <em>{options.top}</em>&#176; </span> <i class="y-icon icon-more"></i> </a> <div class="weather-box"> <div riot-tag="weather"></div> </div> </li> </ul> <div class="y-left y-nav-topbar" riot-tag="nav" if="{!opts.home}"></div> <ul class="y-right"> <li class="tb-item userbox"> <div riot-tag="wuserbox" userinfo="{opts.userInfo}" abtype="{opts.abType}" pageid="{opts.pageId}"></div> </li> <li class="tb-item"> <a onclick="{feedbackClick}" class="tb-link" href="javascript:void(0)">åé¦ˆ</a> </li> <li class="tb-item"> <a class="tb-link" href="https://mp.toutiao.com/profile_introduction/infringement/complain" ga_event="mh_nav_complain" target="_blank">æŠ•è¯‰ä¾µæƒ</a> </li> <li class="tb-item more"> <a class="tb-link" href="/about/">å¤´æ¡äº§å“</a> <div class="layer"> <ul> <li> <a href="https://www.wukong.com" class="layer-item" ga_event="mh_nav_others" target="_blank">é—®ç­”</a> </li> <li> <a href="https://mp.toutiao.com/" class="layer-item" target="_blank" ga_event="mh_nav_others">å¤´æ¡å·</a> </li> <li> <a href="https://tuchong.com/" class="layer-item" target="_blank" ga_event="mh_nav_others">å›¾è™«</a> </li> <li> <a href="https://stock.tuchong.com/?source=ttweb" target="_blank" ga_event="mh_nav_others" class="layer-item">æ­£ç‰ˆå›¾åº“</a> </li> <li> <a href="https://ad.toutiao.com/promotion/?source2=pchometop" class="layer-item" target="_blank" ga_event="mh_nav_ad">å¹¿å‘ŠæŠ•æ”¾</a> </li> </ul> </div> </li> </ul> <div id="J_userFeedback"></div> </div>',function(t){this.options={city:"",state:"",top:0,low:0,userInfo:t.userInfo};var i=this.tags.weather;this.tags.userFeedback,this.init=function(){if(this.opts.home){var t=Cookies.get("WEATHER_CITY")||"";this._getWeather({city:t})}}.bind(this),this._getWeather=function(t){var s=this;http({url:"/stream/widget/local_weather/data/",method:"GET",data:t,success:function(t){t=t||{},"success"===t.message&&(s._renderWeather(t.data.weather),i&&i.trigger("weatherChange",t.data.weather))}})}.bind(this),this._renderWeather=function(t){this.options.weather=t,this.options.city=t.city_name,this.options.state=t.current_condition,this.options.top=t.high_temperature,this.options.low=t.low_temperature,this.update()}.bind(this),this.init(),this.on("weatherChange",function(t){this._renderWeather(t)}),this.on("mount",function(){var t=utils.getHashValue("#userFeedback");1==t&&riot.mount(".wtopbar #J_userFeedback","userFeedback",{})}),this.feedbackClick=function(){riot.mount(".wtopbar #J_userFeedback","userFeedback",{})}.bind(this)}),riot.tag("wuserbox",'<div class="y-box wuserbox"> <a if="{options.id && options.isPgc}" class="y-left new-article" href="http://mp.toutiao.com/new_article/" ga_event="mh_write">å‘æ–‡</a> <div if="{options.id}" class="y-right username"> <a ga_event="mh_nav_user" class="user-head" href="//www.toutiao.com/c/user/{options.id}/" target="_blank" rel="nofollow"> <div class="user-image"> <img onload="this.style.opacity=1;" riot-src="{options.avatarUrl}"> </div> <span>{options.name}</span> </a> <div class="user-layer"> <ul ga_event="mh_nav_user"> <li><a href="//www.toutiao.com/c/user/{options.id}/?tab=favourite" class="layer-item" target="_blank" rel="nofollow">æˆ‘çš„æ”¶è—</a></li> <li><a href="//www.toutiao.com/c/user/relation/{options.id}/?tab=following" class="layer-item" target="_blank" rel="nofollow">æˆ‘çš„å…³æ³¨</a></li> <li><a href="//www.toutiao.com/c/user/relation/{options.id}/?tab=followed" class="layer-item" target="_blank" rel="nofollow">æˆ‘çš„ç²‰ä¸</a></li> <li> <a href="https://sso.toutiao.com/logout/" class="layer-item" rel="nofollow">é€€å‡º</a> </li> </ul> </div> </div> <div if="{!options.id}" class="nav-login"> <a ga_event="nav_login" href="javascript:;" onclick="{onLoginClick}"> <span>ç™»å½•</span> </a> <div if="{options.alertMsg}" class="y-box login-layer"> <div class="y-left login-alert-icon"></div> <div class="y-right"> <p>æ‰‹æœºå·ç™»å½•ä¸Šçº¿å•¦ï¼ï¼ï¼</p> <p>ç™»å½•åŒæ­¥å¤´æ¡Appé˜…è¯»å…´è¶£ï¼Œæ¨èæ›´ç²¾å‡†ï¼</p> </div> <span onclick="{msgCloseClick}"> <i class="y-icon icon-dislikenewfeed"></i> </span> </div> </div> </div>',function(t){var i=this;t.pageid,t.abtype,this.options={id:t.userinfo.id,name:t.userinfo.name,avatarUrl:t.userinfo.avatarUrl,isPgc:t.userinfo.isPgc||!1,alertMsg:!1},this.onLoginClick=function(){window.location.href="https://sso.toutiao.com/login/"}.bind(this),window.on("userChange",function(t){t&&(i.options.id=t.user_id,i.options.name=t.name,i.options.avatarUrl=t.avatar_url,i._isPgc(),i.update())}),this._isPgc=function(){var t=this;http({url:"/user/pgc_info/",method:"get",cache:!1,success:function(i){i=i||{},"success"===i.message&&i.data.is_pgc_author&&(t.options.isPgc=!0,t.update())}})}.bind(this)}),riot.tag("login",'<div class="login-dialog {hide: options.hide}"> <a class="btn" href="javascript:;" onclick="{hide}"> <i class="icon icon-close"></i> </a> <div class="login-dialog-header"> <h3>é‚®ç®±ç™»å½•</h3> </div> <div class="login-dialog-inner" data-node="inner"> <div class="login-pannel bottom-line"> <form action="/auth/login/" method="POST" onsubmit="{onFormSubmit}"> <ul> <li> <div class="input-group"> <div class="input"> <label>é‚®ç®±</label> <input class="name" name="name_or_email" type="text" placeholder="è¯·ä½¿ç”¨æ‚¨çš„æ³¨å†Œé‚®ç®±" autocomplete="off" spellcheck="false"> </div> </div> </li> <li> <div class="input-group"> <div class="input"> <label>å¯†ç </label> <input class="password" name="password" type="password" data-node="password" placeholder="å¯†ç " autocomplete="off" spellcheck="false"> </div> </div> </li> <li class="captcha-box {show: options.captchaImg}"> <div class="input-group"> <div class="input"> <input class="password" name="captcha" type="text" data-node="captcha" placeholder="éªŒè¯ç " autocomplete="off" spellcheck="false"> <img name="captchaImg" riot-src="{options.captchaImg}"> </div> </div> </li> <li> <div class="input-group"> <input type="checkbox" name="remember_me" checked="" style="vertical-align:top"> <label for="remember_me" class="label">è®°ä½è´¦å·</label> </div> </li> <li> <div class="input-group" style="text-align: center;"> <input type="submit" class="submit-btn" value="ç™»å½•"> <p class="{error: options.errorMsg}">{options.errorMsg}</p> </div> </li> </ul> </form> </div> <div class="login-dialog-header"> <h3>åˆä½œç½‘ç«™è´¦å·ç™»å½•</h3> </div> <div class=""> <ul class="y-box sns_login_list" onclick="{onSnsLoginClick}"> <li class="sinaweibo"> <a href="javascript:;" data-pid="sina_weibo" ga_event="login_sina_weibo"> <i class="icon"></i> æ–°æµªå¾®åš </a> </li> <li class="qqweibo"> <a href="javascript:;" data-pid="qq_weibo" ga_event="login_tencnet_weibo"> <i class="icon"></i> è…¾è®¯å¾®åš </a> </li> <li class="qzone"> <a href="javascript:;" data-pid="qzone_sns" ga_event="login_qqzone"> <i class="icon"></i> QQç©ºé—´ </a> </li> <li class="renren"> <a href="javascript:;" data-pid="renren_sns" ga_event="login_renren"> <i class="icon"></i> äººäººç½‘ </a> </li> <li class="weixin"> <a href="javascript:;" style="margin-right:0;" data-pid="weixin" ga_event="login_wechat"> <i class="icon"></i> å¾®ä¿¡ </a> </li> </ul> </div> </div> </div> <div class="mask {hide: options.hide}"></div>',function(t){var i=this;riot.observable(this),this.options={hide:!0,errorMsg:"",captchaImg:""},this.curSpec={successCb:t.successCb||function(){},errorCb:t.errorCb||function(){}},this.hide=function(){this.options.hide=!0,this.update()}.bind(this),this.onFormSubmit=function(t){t.preventDefault();var i=this,s=http.serialize(t.currentTarget);user.loginByLoc({data:s,successCb:function(t){"function"==typeof i.curSpec.successCb&&i.curSpec.successCb(t),i.hide()},errorCb:function(t){i.password.value="",t=t||{};var s=t.data||{};i.options.errorMsg=s.description||"ç™»å½•å¤±è´¥",s.captcha?(i.captcha.value="",i.options.captchaImg="data:image/gif;base64,"+s.captcha):(i.captcha.value="",i.options.captchaImg=""),"function"==typeof i.curSpec.errorCb&&i.curSpec.errorCb(t),i.update()}})}.bind(this),this.onSnsLoginClick=function(t){var i=utils.getTarget(t),s=utils.getAttribute(i,"data-pid")||utils.getAttribute(i.parentNode,"data-pid");this.hide(),user.loginByOther(s,this.curSpec)}.bind(this),window.on("login",function(t){i.options.hide=!1,t=t||{},i.curSpec={successCb:t.successCb||function(){},errorCb:t.errorCb||function(){}},i.update()})}),riot.tag("userFeedback",'<div class="feedback_dialog"> <div class="dialog-header"> <h3>æ„è§åé¦ˆ</h3> </div> <div class="dialog-inner"> <div class="feedback_panel"> <form onsubmit="{onFormSubmit}"> <p class="label">è”ç³»æ–¹å¼ï¼ˆå¿…å¡«ï¼‰</p> <div class="input-group"> <input class="email" placeholder="æ‚¨çš„é‚®ç®±/QQå·" type="text" name="feedback-email"> </div> <p class="label">æ‚¨çš„æ„è§ï¼ˆå¿…å¡«ï¼‰</p> <div class="input-group"> <textarea style="height:100px;" name="feedback-content" class="content" maxlength="140" placeholder="è¯·å¡«å†™æ‚¨çš„æ„è§ï¼Œä¸è¶…è¿‡140å­—"></textarea> </div> <div class="input-group"> <input type="submit" class="{submit-btn:true,disabled:disabled}" value="æäº¤" __disabled="{disabled}"> <span class="error">{msg}</span> <a class="close" href="javascript:void(0);" onclick="{hide}">[å…³é—­]</a> </div> </form> </div> </div> </div>','class="userFeedback"',function(){this.message={success:"å·²æäº¤,æ„Ÿè°¢æ‚¨çš„æ„è§",fail:"æäº¤é”™è¯¯,è¯·ç¨åé‡è¯•",mail_error:"è¯·è¾“å…¥æ­£ç¡®çš„è”ç³»æ–¹å¼",content_error:"è¯·è¾“å…¥æ‚¨çš„æ„è§",content_length_error:"æ„è§é•¿åº¦è¶…å‡ºé™åˆ¶"};var t=this;this.msg="",this.disabled=!1,this.showMessage=function(t){this.msg=this.message[t],this.update()}.bind(this),this.hide=function(){this.unmount(!0)}.bind(this),this.onFormSubmit=function(){var i=this["feedback-email"],s=this["feedback-content"];return i.value.length<5?(i.focus(),this.showMessage("mail_error")):""===s.value?(s.focus(),this.showMessage("content_error")):(this.msg="",this.disabled=!0,this.update(),void http({headers:{"X-CSRFToken":Cookies.get("csrftoken")},url:"/post_message/",method:"post",data:{appkey:"web",uuid:i.value,content:"["+window.location.host+"]"+s.value},success:function(e){return"success"!==e.message?t.showMessage("fail"):(i.value="",s.value="",t.disabled=!1,t.showMessage("success"),void setTimeout(function(){t.hide()},1e3))},error:function(){t.disabled=!1,t.update(),t.showMessage("fail")}}))}.bind(this)}),riot.tag("toast",'<div name="toast" class="toast-inner" style="opacity: 10; filter:alpha(opacity=1000);"> <span>{opts.msg}</span> </div>','class="toast"',function(){var t=this;this.on("mount",function(){var i=this.toast,s=i.clientWidth,e=i.clientHeight,a=new TAnimation;i.style.cssText+="margin-top:-"+e/2+"px;margin-left:-"+s/2+"px",a.animate({el:i,prop:"opacity",to:0,transitionDuration:2e3},function(){t.unmount(!0)})})}),riot.tag("raw","",function(t){this.root.innerHTML=t.content}),riot.tag("subchannel",'<ul name="subchannel" style="" ga_event="subchannel_click" class="sub-list {sub-list-suspension: options.isTop}"> <li class="sub-item {sub-selected: item.is_current}" each="{item, i in opts.subchannels}"> <a href="/ch/{{item.category}}/">{{item.name}}</a> </li> </ul>','if="{opts.subchannels}" class="subchannel"',function(t){this.options={suspension:t.suspension||!1,isTop:!1},this.init=function(){var t=this;if(this.options.suspension){var i=document.getElementById("subchannel"),s=i.clientWidth;this.subchannel.style.width=s+"px",utils.on(window,"scroll",_.throttle(function(){var s=utils.scrollTop(),e=utils.offset(i);t.options.isTop=s>e.top?!0:!1,t.update()},30))}}.bind(this),this.init()}),riot.tag("loading",'<div if="{options.cssAnimation}" class="loading ball-pulse"> <div></div> <div></div> <div></div> <span>{options.msg}&sdot;&sdot;&sdot;</span> </div> <div if="{!options.cssAnimation}" class="loading loading-normal"> <img src="//s3b.pstatp.com/toutiao/resource/toutiao_web/static/style/image/loading_50c5e3e.gif" alt=""> <span>{options.msg}&sdot;&sdot;&sdot;</span> </div>',function(t){var i=utils.cssAnimationSupport();this.options={cssAnimation:i,msg:t.msg||"æ¨èä¸­"}}),!function(t){var i={};i.getHoney=function(){var t=Math.floor((new Date).getTime()/1e3),i=t.toString(16).toUpperCase(),s=md5(t).toString().toUpperCase();if(8!=i.length)return{as:"479BB4B7254C150",cp:"7E0AC8874BB0985"};for(var e=s.slice(0,5),a=s.slice(-5),o="",n=0;5>n;n++)o+=e[n]+i[n];for(var c="",l=0;5>l;l++)c+=i[l+3]+a[l];return{as:"A1"+o+i.slice(-3),cp:i.slice(0,3)+c+"E1"}},t.ascp=i}(window,document),riot.tag("feedBox",'<div class="feedBox" name="feedBox"> <ul class="imgList"> <li class="img-item" each="{item, i in options.list}"> <a href="{item.source_url}" ga_event="click_photos_feed" target="_blank"> <div class="img-box clearfix"> <span class="pic-num">{item.gallary_image_count}å›¾</span> <div class="image-wrap large" if="{item.gallary_flag === 1}"> <img riot-src="{item.image_list[0].url}" alt=""> </div> <div if="{item.gallary_flag === 2}"> <div class="image-wrap middle left"> <img riot-src="{item.image_list[0].url}" alt=""> </div> <div class="image-wrap small right"> <img riot-src="{item.image_list[1].url}" alt=""> </div> <div class="image-wrap small right"> <img riot-src="{item.image_list[2].url}" alt=""> </div> </div> <div if="{item.gallary_flag === 3}"> <div class="image-wrap small right"> <img riot-src="{item.image_list[0].url}" alt=""> </div> <div class="image-wrap middle left"> <img riot-src="{item.image_list[1].url}" alt=""> </div> <div class="image-wrap small right"> <img riot-src="{item.image_list[2].url}" alt=""> </div> </div> </div> <div class="info"> <p class="des">{item.title}</p> <p class="extra"> <span if="{item.source}">{item.source}&nbsp;â‹…</span> <span if="{item.comments_count && item.comments_count > 0}"> {item.comments_count}è¯„è®º</span> </p> </div> </a> </li> </ul> </div> <div if="{!options.isLoadmore}" class="cloadmore" ga_event="loadmore_photos" onclick="{loadmore}">ç‚¹å‡»åŠ è½½æ›´å¤š</div> <div if="{options.isLoadmore}" riot-tag="loading"></div>',function(t){function i(){var t=ascp.getHoney(),i="";window.TAC&&(i=TAC.sign(s.params.max_behot_time)),s.params=_.extend({},s.params,{as:t.as,cp:t.cp,max_behot_time:s.params.max_behot_time,_signature:i})}riot.observable(this);var s=this,e="/api/pc/feed/",a=!1,o=0;this.options={list:[],isLoadmore:!0,hasMore:!0},this.params={category:t.category,utm_source:"toutiao",max_behot_time:0},this.init=function(){utils.on(window,"scroll",_.throttle(function(){var t=utils.scrollTop(),i=s.feedBox.clientHeight,e=window.screen.height;600>i-t-e&&s.loadmore()},350)),this.getData(function(t){s.check(t)})}.bind(this),this.check=function(){s.update();var t=utils.scrollTop(),i=s.feedBox.clientHeight,e=window.screen.height;o++,300>i-t-e&&3>o?s.getData(function(t){s.check(t)}):(s.options.isLoadmore=!1,s.update())}.bind(this),this.loadmore=function(){s.options.isLoadmore=!0,s.update(),s.getData(function(){s.options.isLoadmore=!1})}.bind(this),this.getData=function(t){a||(a=!0,i(),http({url:e,method:"get",data:s.params,success:function(i){"success"===i.message&&(s.options.list=s.options.list.concat(i.data),s.params.max_behot_time=i.next.max_behot_time,s.options.has_more=i.hasMore),a=!1,t&&t(i),s.update()},error:function(){a=!1,t&&t({}),s.update()}}))}.bind(this),this.init()}),riot.tag("feedBack",'<ul class="feedback {feedback-display: options.isShow}"> <li class="tool-item" ga_event="click_homepage_interactive"> <a href="/" target="_self"> <i class="y-icon icon-home"></i> </a> </li> <li class="tool-item go-top" onclick="{goTop}" ga_event="click_top_interactive"> <a href="javascript:;"> <i class="y-icon icon-backtotopfeed"></i> </a> </li> </ul>',function(){this.options={isShow:!1},this.init=function(){var t=this;utils.on(window,"scroll",_.throttle(function(){var i=utils.scrollTop();t.options.isShow=400>i?!1:!0,t.update()},350))}.bind(this),this.goTop=function(){window.scrollTo(0,0)}.bind(this),this.init()}),Function(function(t){return'e(e,a,r){(b[e]||(b[e]=t("x,y","x "+e+" y")(r,a)}a(e,a,r){(k[r]||(k[r]=t("x,y","new x[y]("+Array(r+1).join(",x[y]")(1)+")")(e,a)}r(e,a,r){n,t,s={},b=s.d=r?r.d+1:0;for(s["$"+b]=s,t=0;t<b;t)s[n="$"+t]=r[n];for(t=0,b=s=a;t<b;t)s[t]=a[t];c(e,0,s)}c(t,b,k){u(e){v[x]=e}f{g=,ting(bg)}l{try{y=c(t,b,k)}catch(e){h=e,y=l}}for(h,y,d,g,v=[],x=0;;)switch(g=){case 1:u(!)4:f5:u((e){a=0,r=e;{c=a<r;c&&u(e[a]),c}}(6:y=,u((y8:if(g=,lg,g=,y===c)b+=g;else if(y!==l)y9:c10:u(s(11:y=,u(+y)12:for(y=f,d=[],g=0;g<y;g)d[g]=y.charCodeAt(g)^g+y;u(String.fromCharCode.apply(null,d13:y=,h=delete [y]14:59:u((g=)?(y=x,v.slice(x-=g,y:[])61:u([])62:g=,k[0]=65599*k[0]+k[1].charCodeAt(g)>>>065:h=,y=,[y]=h66:u(e(t[b],,67:y=,d=,u((g=).x===c?r(g.y,y,k):g.apply(d,y68:u(e((g=t[b])<"<"?(b--,f):g+g,,70:u(!1)71:n72:+f73:u(parseInt(f,3675:if(){bcase 74:g=<<16>>16g76:u(k[])77:y=,u([y])78:g=,u(a(v,x-=g+1,g79:g=,u(k["$"+g])81:h=,[f]=h82:u([f])83:h=,k[]=h84:!085:void 086:u(v[x-1])88:h=,y=,h,y89:u({e{r(e.y,arguments,k)}e.y=f,e.x=c,e})90:null91:h93:h=0:;default:u((g<<16>>16)-16)}}n=this,t=n.Function,s=Object.keys||(e){a={},r=0;for(c in e)a[r]=c;a=r,a},b={},k={};r'.replace(/[-]/g,function(i){return t[15&i.charCodeAt(0)]})}("v[x++]=v[--x]t.charCodeAt(b++)-32function return ))++.substrvar .length(),b+=;break;case ;break}".split("")))()('gr$Daten Ğ˜b/s!l yÍ’yÄ¹g,(lfi~ah`{mv,-n|jqewVxp{rvmmx,&effkx[!cs"l".Pq%widthl"@q&heightl"vr*getContextx$"2d[!cs#l#,*;?|u.|uc{uq$fontl#vr(fillTextx$$é¾˜à¸‘à¸ ê²½2<[#c}l#2q*shadowBlurl#1q-shadowOffsetXl#$$limeq+shadowColorl#vr#arcx88802[%c}l#vr&strokex[ c}l"v,)}eOmyoZB]mx[ cs!0s$l$Pb<k7l l!r&lengthb%^l$1+s$jl  s#i$1ek1s$gr#tack4)zgr#tac$! +0o![#cj?o ]!l$b%s"o ]!l"l$b*b^0d#>>>s!0s%yA0s"l"l!r&lengthb<k+l"^l"1+s"jl  s&l&z0l!$ +["cs\'(0l#i\'1ps9wxb&s() &{s)/s(gr&Stringr,fromCharCodes)0s*yWl ._b&s o!])l l Jb<k$.aj;l .Tb<k$.gj/l .^b<k&i"-4j!+& s+yPo!]+s!l!l Hd>&l!l Bd>&+l!l <d>&+l!l 6d>&+l!l &+ s,y=o!o!]/q"13o!l q"10o!],l 2d>& s.{s-yMo!o!]0q"13o!]*Ld<l 4d#>>>b|s!o!l q"10o!],l!& s/yIo!o!].q"13o!],o!]*Jd<l 6d#>>>b|&o!]+l &+ s0l-l!&l-l!i\'1z141z4b/@d<l"b|&+l-l(l!b^&+l-l&zl\'g,)gk}ejo{cm,)|yn~Lij~em["cl$b%@d<l&zl\'l $ +["cl$b%b|&+l-l%8d<@b|l!b^&+ q$sign ',[TAC={}]),function(){}(window,document,void 0);